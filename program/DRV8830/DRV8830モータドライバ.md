# DRV8830モータドライバ

今回の自動操縦カーに搭載されているのは左右独立型のギアボックス．つまり，左右の動きを別々に制御できるというものです．そのため小回りを効かせることができ．サーボの分も減らすことができるので自動走行のプログラムも簡素に書くことが可能になります．

### データシート

- DRV8830自体のものは　　[こちら](https://strawberry-linux.com/pub/drv8830j.pdf)
- 今回ラジコンカーに乗っている表面実装などが住んでいるものは [こちら](http://akizukidenshi.com/download/ds/akizuki/AE-MOTOR8830_manual.pdf)

### 接続方法

このICはGPIOではなくI2Cデバイスになっているので，最初にRaspberry pi側でI2Cを有効にしなければいけません．そのためにはまずはterminalから `sudo raspi-config` でRaspberry piのセッティング画面に入り， `5-Interfacing Option` の I2Cを有効化する必要があります．

また，このモータドライバのアドレスはデフォルトで 0x64 に設定されています．しかし，今回は２つラジコンカーに乗せているので，アドレスを変更しなければいけません．アドレスが一緒のままでいると，二つが連動して動くことになるので．アドレスの変更は必須になります．

データシートによると，配線でアドレスを変更できるとなっていますが，今回はハンダを用いてアドレスを変更しました．ちなみにアドレスはこのままではなく，1ビット右にシフトした値がアドレスになります．

![](http://i.imgur.com/FH8UZrPl.png)

今回は 0x62 に変更をしたので A0 ピンの上側にハンダを付け A1 ピンの下側にハンダをつけました．この理論でいけば9通りまでのアドレスの変更が可能です．

そして配線をし，terminal上で確認するとこのようになるはずだと思われます．

    $ sudo i2cdetect -y 1
    
    0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f
    00:          -- -- -- -- -- -- -- -- -- -- -- -- -- 
    10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
    20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
    30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
    40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
    50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
    60: -- -- 62 -- 64 -- -- -- -- -- -- -- -- -- -- -- 
    70: -- -- -- -- -- -- -- --                         

こうなればRaspberry pi上で二つのモータードライバが認識されていることになっています．